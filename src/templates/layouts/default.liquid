{% assign page_lang = page.lang | default: settings['LanguageLocale/Code'] | default: 'en-us' %}
{% assign lang_attribute = page_lang | split: '_' | first | default: page_lang %}
<!DOCTYPE html>
<html lang="{{ lang_attribute }}" class="rcsa-shell">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>
      {% if page.title %}{{ page.title }} - {% endif %}RCSA Copilot Demo
    </title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      integrity="sha384-Jou7GeUXrXe3G5UpiRaY1o1cnZ6+QcmGeX+z9K/Y/xFdVtOfvtTDHkJNNZ4wNG0F"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
      integrity="sha384-y835ukgqS0bkkCm1cWozNVb1DsqH1I9j5L4A2jpyQ3sTJS3BM4tiTqcKoysznXyI"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="{{ '/design-system/rcsa-tokens.css' | relative_url }}"
    />
    <link
      rel="stylesheet"
      href="{{ '/design-system/rcsa-utilities.css' | relative_url }}"
    />
    <link
      rel="stylesheet"
      href="{{ '/design-system/rcsa-components.css' | relative_url }}"
    />
    {% if content_for_head %}
      {{ content_for_head }}
    {% endif %}
  </head>
  <body class="rcsa-shell__body">
    {% include 'header' %}
    <main id="mainContent" class="rcsa-shell__main" role="main">
      {{ content }}
    </main>
    {% include 'footer' %}

    {% comment %}
      Analytics stub required by docs/target-architecture-blueprint.md:45.
      Downstream agents replace this include with production instrumentation.
    {% endcomment %}
    <script id="rcsa-analytics-stub" type="application/json">
      {
        "session": "{{ request.sessionid | default: 'local-preview' }}",
        "timestamp": "{{ 'now' | date: '%Y-%m-%dT%H:%M:%SZ' }}",
        "events": []
      }
    </script>

    {% if content_for_footer %}
      {{ content_for_footer }}
    {% endif %}
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-OLWM3YP1uAv89xDSHLVbkP4SRrped1IovnHgwlHGawEq+y3OC/YLXTr4Wr9LJx0x"
      crossorigin="anonymous"
      defer
    ></script>
  </body>
</html>
